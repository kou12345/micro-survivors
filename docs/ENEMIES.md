# 敵キャラクター仕様

> このドキュメントは `public/js/weapons.js` の `ENEMY_TYPES` と対応しています。
> コードを変更した場合は、このドキュメントも更新してください。

## 敵一覧

### 雑菌（Germ）

| 項目 | 値 |
|------|-----|
| 見た目 | 緑のつぶつぶ（12角形） |
| 色 | #2ecc71 |
| サイズ | 12px |
| HP | 15 |
| 移動速度 | 1 |
| 接触ダメージ | 5 |
| 経験値 | 3 |

**特徴**: 最も基本的な敵。大量に出現する。

**出現条件**: ゲーム開始時から出現

---

### ウイルス（Virus）

| 項目 | 値 |
|------|-----|
| 見た目 | 赤い丸（トゲ付き） |
| 色 | #e74c3c |
| サイズ | 10px |
| HP | 8 |
| 移動速度 | 2.5 |
| 接触ダメージ | 8 |
| 経験値 | 5 |

**特徴**: 素早いが低体力。回避が難しい。

**出現条件**: ゲーム進行10%以降（約1分後）

---

### バクテリア（Bacteria）

| 項目 | 値 |
|------|-----|
| 見た目 | 棒状（角丸長方形） |
| 色 | #9b59b6 |
| サイズ | 20px |
| 横幅 | 30px |
| 縦幅 | 12px |
| HP | 40 |
| 移動速度 | 0.8 |
| 接触ダメージ | 12 |
| 経験値 | 10 |

**特徴**: 体力が多く倒しにくい。ゆっくり近づいてくる。

**出現条件**: ゲーム進行30%以降（約3分後）

---

### 胞子（Spore）

| 項目 | 値 |
|------|-----|
| 見た目 | オレンジの球体（周囲に小胞子） |
| 色 | #f39c12 |
| サイズ | 14px |
| HP | 25 |
| 移動速度 | 0.6 |
| 接触ダメージ | 5 |
| 経験値 | 8 |
| 攻撃タイプ | 遠距離 |
| 攻撃射程 | 200px |
| 好む距離 | 150px |
| 攻撃間隔 | 2000ms |
| 弾速 | 3 |
| 弾ダメージ | 10 |
| 弾サイズ | 6px |
| 弾の色 | #e67e22 |

**特徴**: 遠距離攻撃をする敵。一定距離を保ちながら弾を発射する。近づくと後退する。

**出現条件**: ゲーム進行20%以降（約2分後）

---

## ボス敵

### 耐性菌ボス（Boss）

| 項目 | 値 |
|------|-----|
| 見た目 | 紫の大型菌（怒り顔） |
| 色 | #e056fd |
| サイズ | 40px |
| HP | 600 |
| 移動速度 | 1 |
| 接触ダメージ | 60 |
| 経験値 | 150 |
| 攻撃パターン | 近接追従 |

**特徴**: 基本のボス敵。高いHPとダメージを持ち、プレイヤーを追いかける。

**出現条件**: ウェーブ1から出現

---

### 巨大アメーバ（Amoeba Boss）

| 項目 | 値 |
|------|-----|
| 見た目 | 緑の大型アメーバ（偽足付き） |
| 色 | #00b894 |
| サイズ | 50px |
| HP | 800 |
| 移動速度 | 0.6 |
| 接触ダメージ | 40 |
| 経験値 | 180 |
| 攻撃パターン | 分裂 |
| 分裂閾値 | HP 75%, 50%, 25% |
| 分裂数 | 2体/回 |

**特徴**: HPが減ると分裂してミニアメーバを生み出す。合計6体のミニアメーバを召喚可能。

**出現条件**: ウェーブ3から出現

---

### 癌細胞（Cancer Boss）

| 項目 | 値 |
|------|-----|
| 見た目 | 赤の異形細胞（複数核） |
| 色 | #d63031 |
| サイズ | 45px |
| HP | 500 |
| 移動速度 | 0.8 |
| 接触ダメージ | 30 |
| 経験値 | 200 |
| 攻撃パターン | 弾幕 |
| 攻撃間隔 | 1500ms |
| 弾速 | 4 |
| 弾ダメージ | 15 |
| 弾数 | 5発（扇状） |

**特徴**: 遠距離から5方向に弾を発射する。一定距離を保ちながら攻撃。

**出現条件**: ウェーブ5から出現

---

### ウイルス母体（Virus Boss）

| 項目 | 値 |
|------|-----|
| 見た目 | 紫の大型ウイルス（スパイク付き） |
| 色 | #6c5ce7 |
| サイズ | 55px |
| HP | 700 |
| 移動速度 | 0.5 |
| 接触ダメージ | 50 |
| 経験値 | 220 |
| 攻撃パターン | 召喚 |
| 召喚間隔 | 3000ms |
| 召喚数 | 4体 |

**特徴**: 定期的にミニウイルスを召喚する。召喚中は停止して光る。

**出現条件**: ウェーブ7から出現

---

### ミニアメーバ（Mini Amoeba）

| 項目 | 値 |
|------|-----|
| 見た目 | 薄緑の小型アメーバ |
| 色 | #55efc4 |
| サイズ | 18px |
| HP | 60 |
| 移動速度 | 1.2 |
| 接触ダメージ | 15 |
| 経験値 | 15 |

**特徴**: 巨大アメーバの分裂で生まれる。素早い動きでプレイヤーを追う。

**出現条件**: 巨大アメーバの分裂時のみ

---

## ボスのスケーリング

ボスはウェーブ番号に応じてスケールします：

```
実際のHP = 基本HP × (1 + waveNumber × 0.5)
実際のダメージ = 基本ダメージ × (1 + waveNumber × 0.2)
実際のXP = 基本XP × (1 + waveNumber × 0.3)
```

- ウェーブ1: HP +50%, ダメージ +20%, XP +30%
- ウェーブ2: HP +100%, ダメージ +40%, XP +60%
- ウェーブ3: HP +150%, ダメージ +60%, XP +90%
- ...

---

## 敵のスケーリング

### 時間経過によるHP補正

敵のHPはゲーム進行に応じてスケールします：

```
実際のHP = 基本HP × (1 + progress × 2)
```

- `progress` = 経過時間 / ゲーム時間
- 例: 5分経過（10分ゲーム）の場合、progress = 0.5
  - HP倍率 = 1 + 0.5 × 2 = 2倍

### ウェーブ時の追加補正

ウェーブで出現する敵は追加でHP補正を受けます：

```
実際のHP = 基本HP × (1 + progress × 2) × (1 + waveNumber × 0.1)
```

- ウェーブ1: +10%
- ウェーブ2: +20%
- ウェーブ3: +30%
- ...

---

## 敵の行動パターン

### 近接型（germ, virus, bacteria）

1. **移動**: プレイヤーに向かって直線的に移動
2. **攻撃**: プレイヤーとの接触時にダメージを与える
3. **死亡**: HPが0になるとXPオーブをドロップ

```javascript
// 移動ロジック（entities.js より）
const dx = player.x - this.x;
const dy = player.y - this.y;
const dist = Math.hypot(dx, dy);
this.x += (dx / dist) * this.speed;
this.y += (dy / dist) * this.speed;
```

### 遠距離型（spore）

1. **移動**:
   - 射程外の場合：プレイヤーに向かって移動
   - 好む距離より近い場合：プレイヤーから離れる（後退）
   - 射程内の場合：その場で停止
2. **攻撃**: 射程内でクールダウン完了後、プレイヤーに向かって弾を発射
3. **接触ダメージ**: 接触時にも少量のダメージを与える
4. **死亡**: HPが0になるとXPオーブをドロップ

### ボス：分裂型（amoeba_boss）

1. **移動**: プレイヤーに向かってゆっくり移動
2. **分裂**: HPが閾値（75%, 50%, 25%）を下回ると、2体のミニアメーバを召喚
3. **接触ダメージ**: 接触時にダメージを与える
4. **死亡**: HPが0になるとXPオーブをドロップ

### ボス：弾幕型（cancer_boss）

1. **移動**:
   - 射程外の場合：プレイヤーに向かって移動
   - 好む距離より近い場合：プレイヤーから離れる
2. **攻撃**: 射程内で1.5秒ごとに5発の扇状弾幕を発射
3. **接触ダメージ**: 接触時にダメージを与える
4. **死亡**: HPが0になるとXPオーブをドロップ

### ボス：召喚型（virus_boss）

1. **移動**: プレイヤーに向かってゆっくり移動（召喚中は停止）
2. **召喚**: 3秒ごとに4体のミニウイルスを周囲に召喚
3. **召喚アニメーション**: 召喚時は光りながら膨張
4. **接触ダメージ**: 接触時にダメージを与える
5. **死亡**: HPが0になるとXPオーブをドロップ

---

## スポーン仕様

### 通常スポーン

- スポーン間隔: `1000ms - min(経過時間/1000, 800)ms`
  - 開始時: 約1秒に1体
  - 終盤: 約0.2秒に1体
- スポーン位置: プレイヤーから画面外（約100px外側）
- スポーン角度: ランダム（360度）

### ウェーブスポーン

- 発生間隔: 30秒ごと
- 予告: 3秒前に警告表示
- 基本敵数: 15体
- 増加数: ウェーブごとに+8体
- スポーン配置: プレイヤーを囲む円形

---

## 実装ファイル

- 敵定義: `public/js/weapons.js` - `ENEMY_TYPES` オブジェクト
- 敵クラス: `public/js/entities.js` - `Enemy` クラス
- 敵の弾: `public/js/state.js` - `enemyProjectiles` 配列
- スポーンロジック: `public/js/game.js` - `spawnEnemy()`, `spawnWave()`
- 弾の更新・描画: `public/js/game.js` - `update()`, `draw()`
- 描画処理: `public/js/entities.js` - `Enemy.draw()`
